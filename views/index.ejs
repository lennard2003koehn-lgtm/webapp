<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ToDo (PaaS)</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 720px; margin: 40px auto; padding: 0 16px; }
    form { margin: 12px 0; display: flex; gap: 8px; }
    input { flex: 1; padding: 10px; }
    button { padding: 10px 12px; cursor: pointer; }
    li { display: flex; align-items: center; justify-content: space-between; padding: 10px; border: 1px solid #ddd; border-radius: 10px; margin: 8px 0; }
    .done { text-decoration: line-through; opacity: 0.6; }
    .actions { display: flex; gap: 8px; }
  </style>
</head>
<body>
  <h1>ToDo – dynamische Web-Anwendung</h1>

  <p>
    Nachweis „dynamisch“: Neue Einträge via Formular (POST) werden serverseitig verarbeitet
    und in PostgreSQL gespeichert. Danach erscheinen sie in der Liste.
  </p>

  <form action="/add" method="post">
    <input name="text" placeholder="Neue Aufgabe…" required />
    <button type="submit">Hinzufügen</button>
  </form>

  <ul style="list-style:none; padding:0;">
    <% todos.forEach(t => { %>
      <li>
        <div class="<%= t.done ? 'done' : '' %>">
          <strong>#<%= t.id %></strong> — <%= t.text %>
        </div>

        <div class="actions">
          <form action="/toggle/<%= t.id %>" method="post">
            <button type="submit"><%= t.done ? 'Undo' : 'Done' %></button>
          </form>
          <form action="/delete/<%= t.id %>" method="post">
            <button type="submit">Löschen</button>
          </form>
        </div>
      </li>
    <% }) %>
  </ul>

  <% if (todos.length === 0) { %>
    <p><em>Noch keine Aufgaben. Füge oben eine hinzu.</em></p>
  <% } %>
</body>
</html>
